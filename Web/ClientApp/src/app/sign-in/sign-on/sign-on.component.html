<div class="wrap">
    <div class="content">
        <tui-stepper [(activeItemIndex)]="activeIndex" class="stepper tui-space_bottom-5">
            <button *ngFor="let step of getStepper; let i = index" tuiStep [state]="getState(i)">{{ step }}</button>
        </tui-stepper>
        <form [formGroup]="signOnForm">
            <ng-container *transloco="let t" [ngSwitch]="activeIndex">
                <qtt-sign-on-form
                    *ngSwitchCase="0"
                    [disabled]="signOnForm.invalid"
                    [title]="t('signIn.signOn.username.title')"
                    (completed)="onCompleted()"
                >
                    <tui-input
                        formControlName="username"
                        tuiTextfieldSize="l"
                        [tuiTextfieldCustomContent]="
                            signOnForm.get('username')?.hasError('usernameAlreadyExists') ? error : success
                        "
                    >
                        {{ t('signIn.signOn.username.placeholder') }}
                        <input tuiTextfield />
                    </tui-input>
                    <tui-error formControlName="username" [error]="[] | tuiFieldError | async"></tui-error>

                    <ng-template #success>
                        <tui-svg src="tuiIconCheckLarge" class="success tui-space_left-3"></tui-svg>
                    </ng-template>
                    <ng-template #error>
                        <tui-svg src="tuiIconAlertCircleLarge" class="error tui-space_left-3"></tui-svg>
                    </ng-template>
                </qtt-sign-on-form>
                <qtt-sign-on-form
                    *ngSwitchCase="1"
                    [disabled]="signOnForm.invalid"
                    [title]="t('signIn.signOn.name.title')"
                    (completed)="onCompleted()"
                >
                    <tui-input formControlName="firstName" tuiTextfieldSize="l">
                        {{ t('signIn.signOn.name.firstName') }}
                        <input tuiTextfield />
                    </tui-input>
                    <tui-error formControlName="firstName" [error]="[] | tuiFieldError | async"></tui-error>

                    <tui-input class="tui-space_top-2" formControlName="lastName" tuiTextfieldSize="l">
                        {{ t('signIn.signOn.name.lastName') }}
                        <input tuiTextfield />
                    </tui-input>
                    <tui-error formControlName="lastName" [error]="[] | tuiFieldError | async"></tui-error>
                </qtt-sign-on-form>
                <qtt-sign-on-form
                    *ngSwitchCase="2"
                    [title]="t('signIn.signOn.avatar.title')"
                    [isFinish]="true"
                    [disabled]="signOnForm.invalid"
                    (completed)="onCompleted()"
                >
                    <div class="avatar-wrap tui-space_bottom-3">
                        <tui-avatar [text]="getFullName" size="xxl" [autoColor]="false" [rounded]="true"></tui-avatar>
                    </div>
                </qtt-sign-on-form>
            </ng-container>
        </form>
    </div>
</div>
